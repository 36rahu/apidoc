{%- import "helper/code.html" as code %}
{%- import "helper/util.html" as util %}

{%- if method.description %}
    <p class="description stack">{{ method.description }}</p>
{%- endif %}
    <div class="request stack">
        <h5><i class="icon-upload"></i> Request: </h5>
        <h6>Resource: </h6>
        <code><span class="hur">{{ method.full_uri }}</span></code>

{%- if method.cleaned_request_parameters %}
        <h6>URI Parameters: </h6>
    {%- call util.render_table([{"name": "Parameter"},
        {"width": "160px", "name": "Type"},
        {"width": "70px", "name": "Optional"},
        {"width": "50%", "name": "Description"}]) %}
        {%- for parameter in method.cleaned_request_parameters.values()|sort %}
                <tr>
                    <td><span class="str">{{ util.none_to_empty(parameter.name) }}</span></td>
                    <td><span class="typ type_link">{{ util.none_to_empty(parameter.type) }}</span></td>
                    <td><span class="lit">{% if parameter.optional %}Optional{% endif %}</span></td>
                    <td><span class="com">{{ util.none_to_empty(parameter.description) }}</span></td>
                </tr>
        {%- endfor %}
    {%- endcall %}
{%- endif %}

{%- if method.request_headers %}
        <h6>Headers: </h6>
    {%- call util.render_table([{"name": "Parameter"},
        {"width": "160px", "name": "Type"},
        {"width": "50%", "name": "Description"}]) %}
        {%- for parameter in method.request_headers.values()|sort %}
                <tr>
                    <td><span class="str">{{ util.none_to_empty(parameter.name) }}</span></td>
                    <td><span class="typ type_link">{{ util.none_to_empty(parameter.type) }}</span></td>
                    <td><span class="com">{{ util.none_to_empty(parameter.description) }}</span></td>
                </tr>
        {%- endfor %}
    {%- endcall %}
{%- endif %}

{%- if method.request_body %}
        <h6>Body: </h6>
        <div class="code"><table class="table-hover">
            <colgroup>
                <col width="50%%"></col>
                <col width="50%%"></col>
            </colgroup>
            <tbody>
    {{ code.code_commented(method.request_body) }}
            </tbody>
        </table></div>
{%- endif %}
    </div>

    <div class="response stack">
        <h5><i class="icon-download"></i> Response: </h5>
{%- if method.response_body %}
        <h6>Body: </h6>
        <div class="code"><table class="table-hover">
            <colgroup>
                <col width="50%%"></col>
                <col width="50%%"></col>
            </colgroup>
            <tbody>
    {{ code.code_commented(method.response_body) }}
            </tbody>
        </table></div>
{%- endif %}

{%- if method.response_codes %}
        <h6>Codes: </h6>
    {%- call util.render_table([{"width": "50px", "name": "Code"},
        {"name": "Message"},
        {"width": "50%", "name": "Description"}]) %}
        {%- for parameter in method.response_codes|sort %}
                <tr>
                    <td><span class="lit">{{ util.none_to_empty(parameter.code) }}</span></td>
                    <td><span class="str">{{ util.none_to_empty(parameter.message) }}</span></td>
                    <td><span class="com">{{ util.none_to_empty(parameter.description) }}</span></td>
                </tr>
        {%- endfor %}
    {%- endcall %}
{%- endif %}
    </div>

    <div class="sample stack">
        <h5><i class="icon-play-circle"></i> Sample: </h5>
        <h6>Request: </h6>
        <div class="code">
{{- "" -}}
<span class="hme">
{%- if method.method|lower == 'http' -%}
    GET
{%- else -%}
    {{ method.method|upper }}
{%- endif -%}
        </span> <span class="hur">
{{- code.uri_sampled(method.uri, method.request_parameters) -}}
        </span> <span class="hpr">HTTP/1.1</span>
<span class="hat">Content-Type</span><span class="pun">: </span><span class="hva">application/json; charset=utf-8</span>
{%- for parameter in method.request_headers.values()|sort %}
<span class="hat">{{ parameter.name }}</span><span class="pun">: </span><span class="hva">{{ util.none_to_empty(parameter.sample) }}</span>
{%- endfor %}
{% if method.request_body -%}
{{ code.code_sampled(method.request_body) -}}
{%- endif -%}
        </div>
        <h6>Response: </h6>
        <div class="code">
{{- "" -}}
<span class="hpr">HTTP/1.1</span> <span class="lit">{{ method.code }}</span> <span class="str">{{ method.message }}</span>
<span class="hat">Content-Type</span><span class="pun">: </span><span class="hva">application/json; charset=utf-8</span>
{% if method.response_body -%}
{{ code.code_sampled(method.response_body) -}}
{%- endif -%}
        </div>
    </div>